var Ke=Object.defineProperty,Ye=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var de=(t,e,i)=>e in t?Ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,A=(t,e)=>{for(var i in e||(e={}))Le.call(e,i)&&de(t,i,e[i]);if(ue)for(var i of ue(e))Xe.call(e,i)&&de(t,i,e[i]);return t},fe=(t,e)=>Ye(t,qe(e));import{J as Ze,M as ge,O as me,K as Ge,L as k,S as Qe,i as $e,s as et,e as v,c as y,a as w,d as p,b as _,f as B,p as I,N as pe,t as z,g as j,P as g,h as J,Q as _e,R as W,T as tt,m as ve,n as U,o as ye,j as K,l as Y,U as we,V as q,W as L,X as it}from"./vendor-d648d7c7.js";function st(){function t(i,r=2){for(i=i.toString();i.length<r;)i=`0${i}`;return i}const e=new Date;return`${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}.${t(e.getMilliseconds(),3)}`}class P extends Ze{}function rt(t){return Object.getPrototypeOf(t).constructor}function be(t){return t*.062}function nt(t){let e=0,i,r;if(t.length===0)return e;for(i=0;i<t.length;i++)r=t.charCodeAt(i),e=(e<<5)-e+r,e|=0;return e}function ot(t,e,i){return i===void 0?Math.floor(new ge(Math.random()*1e5).rndHiRes()*(e+1-t))+t:(typeof i=="string"&&(i=nt(i)),Math.floor(new ge(i).rndHiRes()*(e+1-t))+t)}function xe(t){return t[ot(0,t.length-1)]}function Oe(t){const e=Array.isArray(t)?t:t.split(`
`),i=Math.max(...e.map(s=>s.length)),r=[`\u250C\u2500${"\u2500".repeat(i)}\u2500\u2510`];for(const s of e)r.push(`\u2502 ${s}${" ".repeat(i-s.length)} \u2502`);return r.push(`\u2514\u2500${"\u2500".repeat(i)}\u2500\u2518`),r.join(`
`)}function Ae(t){const e=Array.isArray(t)?t:t.split(`
`),i=[];for(const o of e)if(Array.isArray(o)){const a=[];for(const u of o)a.push(...u.split(`
`));const l=Math.max(...a.map(u=>u.length));i.push(...a.map(u=>u.padEnd(l)))}else i.push(...o.split(`
`));const r=Math.max(...i.map(o=>o.length)),s=Math.floor(r*.5),n=Math.floor(r*.5);for(let o=0;o<i.length;o++){const a=i[o];i[o]=" ".repeat(s-a.length*.5)+a+" ".repeat(n-a.length*.5)}return i.join(`
`)}const at=!1,D=9,ke="0.0.0",Ne="untitled game",ie=at,lt=me;var R;(function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(R||(R={}));var Se;(function(t){t[t.LocalStorage=0]="LocalStorage",t[t.Server=1]="Server"})(Se||(Se={}));const De=0;async function Ce(t){switch(De){case 1:{const e=await fetch(`/storage/${t}`);if(e.status===404)return null;if(e.ok===!1)throw new Error(`non-ok error code: ${e.status}`);return JSON.parse(await e.text())}case 0:return JSON.parse(localStorage.getItem(t))}}async function se(t,e){switch(De){case 1:{const i=await fetch(`/storage/${t}`,{method:"PUT",body:JSON.stringify(e)});if(i.ok===!1)throw new Error(`non-ok error code: ${i.status}`);return}case 0:{localStorage.setItem(t,JSON.stringify(e));return}}}var Me;(function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(Me||(Me={}));var X;(function(t){t[t.None=0]="None",t[t.Normal=1]="Normal",t[t.Extreme=2]="Extreme"})(X||(X={}));var Z;(function(t){t[t.None=0]="None",t[t.NonString=1]="NonString",t[t.All=2]="All"})(Z||(Z={}));var Ie;(function(t){t[t.No=0]="No",t[t.Collapsed=1]="Collapsed",t[t.Open=2]="Open"})(Ie||(Ie={}));var Re;(function(t){t[t.Line=0]="Line",t[t.Braille=1]="Braille",t[t.Number=2]="Number",t[t.Wiggle=3]="Wiggle",t[t.Run=4]="Run"})(Re||(Re={}));const re=new P;function ne(t){return t(c),re.on("update",t),()=>re.removeListener("update",t)}const Ee={configBuild:D,timestamp:0,video:{noSelect:!0,fov:80,zoomFov:20,shadows:{enabled:!0,bias:-.001,normalBias:.01,reduceShadowUpdates:!1}},sound:{},input:{keys:{action1:"Mouse0",action2:"Mouse2",jump:"Space",moveBackwards:"KeyS",moveForwards:"KeyW",moveLeft:"KeyA",moveRight:"KeyD",pause:"Escape",use:"KeyE",debug:"F3",fullscreen:"F11",zoom:"KeyC",lookDown:"ArrowDown",lookLeft:"ArrowLeft",lookRight:"ArrowRight",lookUp:"ArrowUp",changePerspective:"F5"},touch:{mouseEmulation:{sensitivity:{multiplier:.09,power:1}}},camera:{mouse:{sensitivity:{multiplier:.09,power:1}},keyboard:{sensitivity:{multiplier:.15}},touch:{sensitivity:{multiplier:.001,power:1}},bodyTurnLock:40,lock:{top:50,bottom:-50}}},performance:{fixedTickerUndershoot:0,cache:1},debug:{failLoad:!1,failStart:!1,devSocket:{enabled:ie,liveStorageReload:{enabled:!0,delay:200}},logging:{level:1,double:0,interceptConsole:!1,hideLoadingLogs:!ie},stats:{show:0,spinner:1}},data:{}},ct={8:t=>(t.cache=t==null?void 0:t.advanced.cache,delete t.advanced.cache,t),9:async t=>{await se(ht,t.configBackups),delete t.configBackups}},oe="settings",ht="settings-backup";let c=Ee;function ut(){return Ge.defaultsDeep(c,Ee)}function ae(){c=ut()}async function At(){b("dbug","generating settings...");try{c=await Ce(oe),ae(),c.timestamp=Date.now();const t=c.configBuild;if(t<D){b("dbug",`settings config is behind! got ${t} while we're at ${D}.`);for(let e=t+1;e<=D;e++){const i=ct[e];typeof i=="function"&&(c=await i(c))}c.configBuild=D,b("dbug","updated settings for latest")}Te(),b("dbug","finished generating settings.")}catch(t){throw b("warn","error generating settings!",t),b("warn","backing up config and generating a new one..."),c===null&&ae(),await se(`settings-backup-${Date.now()}`,await Ce(oe)),dt(),new Error("Failed to generate settings! Your data has been backed up and then reset.")}}function Te(){re.emit("update",c)}async function dt(){b("dbug","saving settings..."),c===null&&ae(),await se(oe,c),Te(),b("dbug","done saving settings")}const E={};for(const t in console)if(Object.prototype.hasOwnProperty.call(console,t)){const e=console[t];E[t]=e}let ze=!1;function ft(){if(ze===!0)return;function t(e,i){console[e]=(...r)=>b(i,...r)}t("debug","dbug"),t("log","info"),t("info","info"),t("warn","warn"),t("error","err!"),ze=!0}ne(t=>{t.debug.logging.interceptConsole===!0&&ft()});const gt={dbug:{stringOutput:k.gray,type:k.gray,logger:E.debug,logLevel:R.Debug},info:{logger:E.log,logLevel:R.Info},warn:{type:k.yellow.inverse,stringOutput:k.yellow,logger:E.warn,logLevel:R.Warn},"err!":{type:k.red.inverse,stringOutput:k.red,logger:E.error,logLevel:R.Error}},je=new P;function b(t,...e){const i=A({time:k.gray,stack:k.gray,type:n=>n,stringOutput:n=>n,logger:E.log},gt[t]);e=e.map(n=>typeof n=="string"?i.stringOutput(n):n);const r=`[${i.time(st())} ${i.type(t)}]`;if(je.emit("outputNotLeveled",[r,...e].join(" ")),c.debug.logging.level<i.logLevel)return;je.emit("output",[r,...e].join(" ")),i.logger(r,...e);const s=c.debug.logging.double;if(s===Z.All)i.logger();else if(s===Z.NonString){let n=!1;for(const o of e)if(typeof o!="string"){n=!0;break}n===!0&&i.logger("")}}const mt=globalThis;mt.ug13Watch={};class Pe{constructor(e,i=!1){this._dirty={},this._alreadyDirty=!0,this._caches=e,this._overkill=i}get dirty(){return Object.freeze(A({},this._dirty))}get caches(){return Object.freeze(A({},this._caches))}dirtyAll(){if(this._alreadyDirty===!1)for(const e in this._dirty)Object.prototype.hasOwnProperty.call(this._dirty,e)&&(this._dirty[e]=!0)}isOverkill(e){return c.performance.cache!==X.Extreme?typeof this._overkill=="boolean"?this._overkill:this._overkill[e]===!0:!1}getDirty(e){return[!0,void 0].includes(this._dirty[e])}setDirty(e,i){return this._dirty[e]=i,i===!1&&(this._alreadyDirty=!1),i}getValue(e){return this._caches[e]}setValue(e,i){return this._caches[e]=i,i}do(e,i){return this.getDirty(e)||c.performance.cache===X.None||this.isOverkill(e)?this.setValue(e,i()):this.getValue(e)}}function pt(t,e,i){const r=A({undershootMultiplier:0},i);let s=performance.now(),n=0;const o=()=>{let a=!0;const l=performance.now(),u=l-s;s=l,n+=u,t>0&&n+u*r.undershootMultiplier<t&&(a=!1),e(o,a?n:null),a===!0&&(n=0)};return o}var Ve;(function(t){t[t.RequestAnimationFrame=0]="RequestAnimationFrame",t[t.SetInterval=1]="SetInterval",t[t.Manual=2]="Manual"})(Ve||(Ve={}));class kt extends P{constructor(e){super();this._options={rate:0,method:1,maxDeltaTime:1/0,undershoot:0},this._active=!1,this._options=A(A({},this._options),e)}capDeltatime(e){return this._options.maxDeltaTime<e?this._options.maxDeltaTime:e}_emitTick(e){this.emit("tick",this.capDeltatime(e),e)}start(){if(!this.active){switch(this._active=!0,this._options.method){case 0:this._simpleTicker((e,i)=>{this._active===!0&&(requestAnimationFrame(e),i&&this._emitTick(i))})();break;case 1:{let e=performance.now();const i=setInterval(()=>{const r=performance.now(),s=r-e;e=r,this.active===!0?this._emitTick(s):clearInterval(i)},this._options.rate)}break;case 2:this.on("manualCallback",this._simpleTicker((e,i)=>{i&&this._emitTick(i)}));break}return this}}get active(){return this._active}manualCallback(){this.emit("manualCallback")}_simpleTicker(e,i){return pt(this._options.rate,e,fe(A({},i),{undershootMultiplier:this._options.undershoot}))}stop(){return this._active=!1,this}}class G extends P{constructor(e,i=null){super();this.vectorHelper=le,this._axis=[],this._emittingChange=!1,this._cache=new Pe({readonlyAxis:null,length:null}),this._initDim=null,this._initDim=i,this._axis=this.vectorHelper.arrayize(e,i)}get axis(){return this._cache.do("readonlyAxis",()=>[...this._axis])}get dimension(){return this._axis.length}set dimension(e){this.setDimension(e)}setDimension(e,i=0){if(this._initDim!==null)throw new Error("You can't change the dimension!");if(i===!0&&(i=this.dimension===1?this._axis[0]:0),e>this.dimension)for(let r=0;r<e;r++)this._axis[r]===void 0&&this._axis.push(i);else this._axis.length=e}clone(e=this._axis){return new(rt(this))(e)}setAxis(e,i){return this._axis[e]=i,this._onAxisChange(e),this}getAxis(e){return this._axis[e]}get length(){return this._cache.do("length",()=>this.vectorHelper.distance(this.clone(0),this))}set length(e){this.setNormalized(),this.setMul(e)}normalized(){const e=this.clone(),i=this.length;return e.setDiv(i),e}setNormalized(){return this.clone(this.normalized())}_onAxisChange(e){this._emittingChange===!1&&(this._emittingChange=!0,this.emit("change",e),this._emittingChange=!1),this._cache.dirtyAll()}set(e){return this._axis=this.vectorHelper.arrayize(e),this._onAxisChange(null),this}calc(e,i){return this.vectorHelper.calc(this,e,i)}add(e){return this.vectorHelper.add(this,e)}sub(e){return this.vectorHelper.sub(this,e)}mul(e){return this.vectorHelper.mul(this,e)}pow(e){return this.vectorHelper.pow(this,e)}div(e){return this.vectorHelper.div(this,e)}mod(e){return this.vectorHelper.mod(this,e)}setCalc(e,i){return this.set(this.vectorHelper.calc(this,e,i))}setAdd(e){return this.set(this.add(e))}setMod(e){return this.set(this.mod(e))}setSub(e){return this.set(this.sub(e))}setMul(e){return this.set(this.mul(e))}setPow(e){return this.set(this.pow(e))}setDiv(e){return this.set(this.div(e))}}class le{static arrayize(e,i){if(typeof e=="number"){const r=[e];if(i)for(let s=0;s<i-1;s++)r.push(e);return r}else return Array.isArray(e)?e:e?[...e.axis]:this.arrayize(0,i)}static distance(e,i){let r=0;const s=e.clone(),n=i.clone();s.dimension!==n.dimension&&(n.dimension=s.dimension);for(let o=0;o<s.axis.length;o++){const a=s.axis[o],l=n.axis[o];r+=(a-l)**2}return Math.sqrt(r)}static calc(e,i,r){const s=new G(e),n=new G(i),o=new G;n.dimension!==s.dimension&&n.setDimension(s.dimension,!0);for(let a=0;a<s.axis.length;a++){const l=s.axis[a],u=n.axis[a];o.setAxis(a,r(l,u))}return o}static add(e,i){return this.calc(e,i,(r,s)=>r+s)}static mod(e,i){return this.calc(e,i,(r,s)=>r%s)}static sub(e,i){return this.calc(e,i,(r,s)=>r-s)}static mul(e,i){return this.calc(e,i,(r,s)=>r*s)}static pow(e,i){return this.calc(e,i,(r,s)=>r**s)}static div(e,i){return this.calc(e,i,(r,s)=>r/s)}static axisNumberToString(e){switch(e){case 0:return"x";case 1:return"y";case 2:return"z";case 3:return"w";default:return e}}}class Q extends G{constructor(e){super(e,3)}get x(){return this.getAxis(0)}set x(e){this.setAxis(0,e)}get y(){return this.getAxis(1)}set y(e){this.setAxis(1,e)}get z(){return this.getAxis(2)}set z(e){this.setAxis(2,e)}}class He extends Q{constructor(...e){super(...e);this._degrees=new Q;let i=!1;this._degrees.on("change",r=>{if(i){i=!1;return}i=!0,this.setAxis(r,this._degrees.getAxis(r)*(Math.PI/180))}),this.on("change",r=>{if(i){i=!1;return}i=!0,this._degrees.setAxis(r,this.getAxis(r)*(180/Math.PI))})}get degrees(){return this._degrees}}function Fe(t,e,i){const r=t.slice();return r[8]=e[i],r}function Be(t){let e,i,r,s=t[5]===!0&&Je(t);return{c(){e=v("div"),s&&s.c(),this.h()},l(n){e=y(n,"DIV",{class:!0});var o=w(e);s&&s.l(o),o.forEach(p),this.h()},h(){_(e,"class","cover svelte-vpo2tz")},m(n,o){B(n,e,o),s&&s.m(e,null),r=!0},p(n,o){t=n,t[5]===!0?s?(s.p(t,o),o&32&&I(s,1)):(s=Je(t),s.c(),I(s,1),s.m(e,null)):s&&(ve(),U(s,1,1,()=>{s=null}),ye())},i(n){r||(I(s),_e(()=>{i||(i=W(e,L,{duration:200,easing:q},!0)),i.run(1)}),r=!0)},o(n){U(s),i||(i=W(e,L,{duration:200,easing:q},!1)),i.run(0),r=!1},d(n){n&&p(e),s&&s.d(),n&&i&&i.end()}}}function Je(t){let e,i,r,s=t[4],n=[];for(let o=0;o<s.length;o+=1)n[o]=We(Fe(t,s,o));return{c(){e=v("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=y(o,"DIV",{class:!0});var a=w(e);for(let l=0;l<n.length;l+=1)n[l].l(a);a.forEach(p),this.h()},h(){_(e,"class","logs svelte-vpo2tz"),pe(e,"suggest",t[6]===!0)},m(o,a){B(o,e,a);for(let l=0;l<n.length;l+=1)n[l].m(e,null);r=!0},p(o,a){if(t=o,a&16){s=t[4];let l;for(l=0;l<s.length;l+=1){const u=Fe(t,s,l);n[l]?n[l].p(u,a):(n[l]=We(u),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=s.length}a&64&&pe(e,"suggest",t[6]===!0)},i(o){r||(_e(()=>{i||(i=W(e,L,{duration:200,easing:q},!0)),i.run(1)}),r=!0)},o(o){i||(i=W(e,L,{duration:200,easing:q},!1)),i.run(0),r=!1},d(o){o&&p(e),tt(n,o),o&&i&&i.end()}}}function We(t){let e,i=t[8]+"",r;return{c(){e=v("div"),r=z(i),this.h()},l(s){e=y(s,"DIV",{class:!0});var n=w(e);r=j(n,i),n.forEach(p),this.h()},h(){_(e,"class","log svelte-vpo2tz")},m(s,n){B(s,e,n),g(e,r)},p(s,n){n&16&&i!==(i=s[8]+"")&&J(r,i)},d(s){s&&p(e)}}}function _t(t){let e,i,r,s,n,o,a,l,u,x,h,$,S,T=Math.floor(t[3]*100)+"",V,ee,H,O,d=t[0]===!0&&Be(t);return{c(){e=v("main"),d&&d.c(),i=K(),r=v("div"),s=v("div"),n=K(),o=v("div"),a=v("div"),l=z(t[2]),u=K(),x=v("div"),h=z(t[1]),$=K(),S=v("div"),V=z(T),ee=z("%"),this.h()},l(f){e=y(f,"MAIN",{class:!0});var m=w(e);d&&d.l(m),i=Y(m),r=y(m,"DIV",{class:!0});var M=w(r);s=y(M,"DIV",{class:!0,style:!0}),w(s).forEach(p),n=Y(M),o=y(M,"DIV",{class:!0});var F=w(o);a=y(F,"DIV",{class:!0});var ce=w(a);l=j(ce,t[2]),ce.forEach(p),u=Y(F),x=y(F,"DIV",{class:!0});var he=w(x);h=j(he,t[1]),he.forEach(p),F.forEach(p),$=Y(M),S=y(M,"DIV",{class:!0});var te=w(S);V=j(te,T),ee=j(te,"%"),te.forEach(p),M.forEach(p),m.forEach(p),this.h()},h(){_(s,"class","bar-filling svelte-vpo2tz"),we(s,"width",t[3]*100+"%"),_(a,"class","text"),_(x,"class","info svelte-vpo2tz"),_(o,"class","description svelte-vpo2tz"),_(S,"class","percent svelte-vpo2tz"),_(r,"class",H="bar "+(t[0]?"visible":"hidden")+" "+(t[7]?"error":"")+" svelte-vpo2tz"),_(e,"class","svelte-vpo2tz")},m(f,m){B(f,e,m),d&&d.m(e,null),g(e,i),g(e,r),g(r,s),g(r,n),g(r,o),g(o,a),g(a,l),g(o,u),g(o,x),g(x,h),g(r,$),g(r,S),g(S,V),g(S,ee),O=!0},p(f,[m]){f[0]===!0?d?(d.p(f,m),m&1&&I(d,1)):(d=Be(f),d.c(),I(d,1),d.m(e,i)):d&&(ve(),U(d,1,1,()=>{d=null}),ye()),(!O||m&8)&&we(s,"width",f[3]*100+"%"),(!O||m&4)&&J(l,f[2]),(!O||m&2)&&J(h,f[1]),(!O||m&8)&&T!==(T=Math.floor(f[3]*100)+"")&&J(V,T),(!O||m&129&&H!==(H="bar "+(f[0]?"visible":"hidden")+" "+(f[7]?"error":"")+" svelte-vpo2tz"))&&_(r,"class",H)},i(f){O||(I(d),O=!0)},o(f){U(d),O=!1},d(f){f&&p(e),d&&d.d()}}}function vt(t,e,i){let{show:r=!0}=e,{info:s=""}=e,{title:n=""}=e,{percent:o=0}=e,{logs:a=[]}=e,{showLogs:l=!1}=e,{suggestLogs:u=!1}=e,{error:x=!1}=e;return t.$$set=h=>{"show"in h&&i(0,r=h.show),"info"in h&&i(1,s=h.info),"title"in h&&i(2,n=h.title),"percent"in h&&i(3,o=h.percent),"logs"in h&&i(4,a=h.logs),"showLogs"in h&&i(5,l=h.showLogs),"suggestLogs"in h&&i(6,u=h.suggestLogs),"error"in h&&i(7,x=h.error)},[r,s,n,o,a,l,u,x]}class Nt extends Qe{constructor(e){super();$e(this,e,vt,_t,et,{show:0,info:1,title:2,percent:3,logs:4,showLogs:5,suggestLogs:6,error:7})}}const N=class{constructor(t){this._parent=null,this._events=new P,this.position=new Q,this.rotation=new He,this.velocity=new Q,this._name="",this._rotationOrder="XYZ",this._cache=new Pe({children:null}),this._children=[],(t!=null?t:!1)?this.setFromJSON(N.thingableToJson(t)):this._rendererObject=new me,this.position.on("change",e=>{this._processVectorChange("position",e)}),this.rotation.on("change",e=>{this._processVectorChange("rotation",e)}),this._stopDoSettings=ne(e=>{const i=this._rendererObject;i.shadow&&(i.shadow.normalBias=e.video.shadows.normalBias,i.shadow.bias=e.video.shadows.bias)}),N._count++}get rotationOrder(){return this._rotationOrder}set rotationOrder(t){this._rotationOrder=t,this._rendererObject.rotation.order=t}toString(){return`[Thing ${this.name}]`}get parent(){return this._parent}set parent(t){this.changeParent(t)}get name(){return this._name}set name(t){this._name=t,this._rendererObject.name=t}_processVectorChange(t,e){if(e===null){const r=this[t].axis;for(let s=0;s<r.length;s++){const n=le.axisNumberToString(s);this._rendererObject[t][n]=r[s]}}const i=le.axisNumberToString(e);this._rendererObject[t][i]=this[t][i]}get children(){return this._cache.do("children",()=>[...this._children])}get rendererObject(){return this._rendererObject}add(t){return this._children.push(t),this._rendererObject.add(t._rendererObject),this._cache.setDirty("children",!0),t.changeParent(this,!1),t}forEveryChild(t,e=!1){for(const i of this._children)t(i),e===!0&&i.forEveryChild(t,!0)}changeParent(t,e=!0){var i;e===!0&&((i=this.parent)==null||i.remove(this),t==null||t.add(this)),this._parent=t}remove(t){for(let e=0;e<this._children.length;e++)if(this._children[e]===t){this._children.splice(e,1);break}return t.changeParent(null,!1),this}getChildFromName(t,e=!1){const i=[];i.push(...this._children);for(let r=0;r<i.length;r++){const s=i[r];if(s.name===t)return s;e&&i.push(...s._children)}return null}static rendererObjectToJSON(t){return{name:t.name,position:t.position.toArray(),rotation:t.rotation.toArray(),rotationOrder:t.rotation.order,velocity:[0,0,0],rendererObject:t.clone(!1).toJSON(),children:t.children.map(e=>this.rendererObjectToJSON(e))}}toJSON(){const t={position:this.position.axis,rotation:this.rotation.axis,velocity:this.velocity.axis,rotationOrder:this.rotationOrder,name:this.name,children:this.children.map(e=>e.toJSON()),rendererObject:this._rendererObject.clone(!1).toJSON()};return this._events.emit("toJSON",t),t}destroy(){var t,e;(e=(t=this._rendererObject).dispose)==null||e.call(t),this._stopDoSettings(),N._count--}setFromJSON(t){if(!Array.isArray(t)){this._rendererObject=new it().parse(t.rendererObject),this.position.set(t.position),this.rotation.set(t.rotation),this.velocity.set(t.velocity),this.rotationOrder=t.rotationOrder,this.name=t.name;for(let e=0;e<this._children.length;e++){const i=this._children[e];this.remove(i)}for(let e=0;e<t.children.length;e++){const i=t.children[e];this.add(new N().setFromJSON(i))}}return this._events.emit("fromJSON",t),this}clone(){return new N(this)}static thingableToJson(t){return t instanceof N?t.toJSON():t instanceof lt?N.rendererObjectToJSON(t):t}static get count(){return this._count}};let Ue=N;Ue._count=0;class St extends Ue{constructor(e,i,r,s,n){super(e);this.model=e,this.world=i,this.input=r,this.camera=s,this.game=n,this._perspective=C.FirstPerson,this._cameraAttached=!1,this.cameraRotation=new He,this.head=this.getChildFromName("head",!0),this.body=this.getChildFromName("body",!0),this.world.add(this),this.perspective=this._perspective,this._setupPlayerCamera(),this._subscribeToControls(),this.forEveryChild(o=>{o.rendererObject.castShadow!==void 0&&(o.rendererObject.castShadow=!0),o.rendererObject.receiveShadow!==void 0&&(o.rendererObject.receiveShadow=!0)},!0),ne(o=>{this.camera.fov=o.video.fov,this.camera.updateProjectionMatrix()})}_setupPlayerCamera(){this.camera.parent.rotationOrder="YXZ",this.camera.rotationOrder="YXZ",this.rotationOrder="YXZ"}get perspective(){return this._perspective}set perspective(e){switch(this._setupPlayerCamera(),e){case C.FirstPerson:this.camera.parent=this.head,this.camera.position.set([0,be(3),be(-3)]),this.camera.rotation.set([0,0,0]),this._cameraAttached=!0;break;case C.ThirdPersonBack:this.camera.parent=this.head,this.camera.position.set([0,0,5]),this.camera.rotation.set([0,0,0]),this._cameraAttached=!0;break;case C.ThirdPersonFront:this.camera.parent=this.head,this.camera.position.set([0,0,-5]),this.camera.rotation.set([0,Math.PI,0]),this._cameraAttached=!0;break;case C.Unattached:this.camera.parent=this.parent,this.camera.rotation.set(this.cameraRotation),this.camera.position.set(this.position.add([0,1,0])),this._cameraAttached=!1}this._perspective=e}_subscribeToControls(){this.input.on("changePerspective",e=>{e===!0&&(this.perspective=(this.perspective+1)%4)}),this.input.on("zoom",e=>{e?this.camera.fov=c.video.zoomFov:this.camera.fov=c.video.fov,this.camera.updateProjectionMatrix()}),this.input.on("camera",e=>{const i=1,r=-e.movement.y*i,s=-e.movement.x*i;this.cameraRotation.degrees.x+=r,this.cameraRotation.degrees.y+=s,this.cameraRotation.degrees.x>c.input.camera.lock.top&&(this.cameraRotation.degrees.x=c.input.camera.lock.top),this.cameraRotation.degrees.x<c.input.camera.lock.bottom&&(this.cameraRotation.degrees.x=c.input.camera.lock.bottom),this.head.rotation.x=this.cameraRotation.x,this.head.rotation.y=this.cameraRotation.y;const n=this.head.rotation.degrees.y-this.body.rotation.degrees.y,o=c.input.camera.bodyTurnLock;Math.abs(n)>=o&&(this.body.rotation.degrees.y+=n%o)}),this.game.on("frameTick",e=>{const i=.01,r=Math.sin(this.cameraRotation.y%(Math.PI*2)),s=Math.cos(this.cameraRotation.y%(Math.PI*2)),n=Math.sin((this.cameraRotation.y+Math.PI*.5)%(Math.PI*2)),o=Math.cos((this.cameraRotation.y+Math.PI*.5)%(Math.PI*2));this.input.getInput("moveForwards")&&(this.position.x-=r*i*e,this.position.z-=s*i*e),this.input.getInput("moveBackwards")&&(this.position.x+=r*i*e,this.position.z+=s*i*e),this.input.getInput("moveLeft")&&(this.position.x-=n*i*e,this.position.z-=o*i*e),this.input.getInput("moveRight")&&(this.position.x+=n*i*e,this.position.z+=o*i*e)})}}var C;(function(t){t[t.FirstPerson=0]="FirstPerson",t[t.ThirdPersonBack=1]="ThirdPersonBack",t[t.ThirdPersonFront=2]="ThirdPersonFront",t[t.Unattached=3]="Unattached"})(C||(C={}));function yt(){try{const t=[...xe(bt)],e=t[0],i=xe(wt);return t.shift(),t.unshift(e+i.split(`
`).join(`
${e}`)),t.push(),Oe(Ae([Oe(Ae([`${Ne} v${ke}`,`build ${D}`,`in ${ie?"development":"production"}`])),"",t]))}catch(t){return b("warn","failed to generate welcome message.",t),`${Ne} v${ke} (${D})`}}const wt=["i'm doing good, right?","development hell? more like hell yeah!","overcomplicated cuz i was bored",'"// @ts-expect-error" my beloved',"boo","i look fatter in text art","we're a svelte family","please keep things tidy","nice to meet you","i have my face yellow. hbu?","uh oh, why are you seeing me...","i worked hard on this.","three whole .jses!",typeof Date!="undefined"?new Date().getHours()<5?`it's ${new Date().getHours()}am, get some rest!`:"i heard sleeping is good for people like you.":"do you have the time?","i'm dabric","don't worry, i'm an expert sometimes",`have you ever scaled the player?
it gives a weird effect.`,[" \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 ","\u2502\u2502 | _ | \u2502\u2502"," \u2514\u252C\u2500\u2500\u2500\u2500\u2500\u252C\u2518 ","  \u2502     \u2502  "].join(`
`),`they say people go missing when
they visit /storage`,"multibot","i'm faster than this game!","how to log4shell javascript?","oh no!","the hashes makes me look fluffy",`this game was a red spinning
cube for a few months`,"HAHAHAHAHAHAHA","<3","i miss linux","so many things it's scary!","confusing code!","am i the software or the hardware?","no comment","what game doesn't run?"],bt=[["        ","       /                ","  ####################  ","####                ####","####  ##        ##  ####","####  ##  ####  ##  ####","####                ####","  ####################  ","    ##            ##    ","    ##            ##    "],["        ","       /                ","  ####################  ","####                ####","####  ##        __  ####","####  ##  ####      ####","####                ####","  ####################  ","    ##            ##    ","    ##            ##    "],["        ","       o                ","      o                 ","  ####################  ","####                ####","####                ####","####  __  ####  __  ####","####                ####","  ####################  ","    ##            ##    ","    ##            ##    "],["             ","            /                       ","        ####################        ","      ####                ####      ","    ######  ##        ##  ######    ","   #######  ##  ####  ##  #######   ","  ##  ####                ####  ##  ","  ##    ####################    ##  ","######    ##            ##    ######","##  ##    ##            ##    ##  ##"],["          ","         /  ######      ","            ======      ","          ##########    ","  ####################  ","####                ####","####  ##        ##  ####","####  ##  ####  ##  ####","####                ####","  ####################  ","    ##            ##    ","    ##            ##    "],["        ","       /                ","  ####################  ","####                ####","####  ##  ####  ##  ####","####  ##        ##  ####","####                ####","  ####################  ","    ##            ##    ","    ##            ##    "],["       ","      /                ","    ##                  ","    ##                  ","  ####################  ","####                ####","####  ##        ##  ####","####  ##  ####  ##  ####","####                ####","  ####################  ","    ##            ##    ","    ##            ##    "],["        ","       /                ","  ####################  ","####                ####","####  ##        ##  ####","####  ##  ####  ##  ####","####                ####","  ####################  ","    ######    ######    ","    ################    "],["        ","       /                ","  ####################  ","####                ####","####  ##        ##  ####","####  ##  ####  ##  ####","####      V  V      ####","  ####################  ","    ##            ##    ","    ##            ##    "],["          ","         /                  ","    ####################    ","  ####                ####  ","  ####  ##        ##  ####  ","  ####  ##  ####  ##  ####  ","  ####                ####  ","    ####################    ","      ##            ##      ","########            ########"],["                 ","                /","      ########   ","    ############ ","######        ## ","    ##  ####  ## ","    ##        ## ","    ##  #     ## ","    ##  #     ## ","    ##        ## ","    ##  ####  ## ","######        ## ","    ############ ","      ########   "]],Dt=yt();export{Pe as C,Nt as L,St as P,Re as S,P as T,G as V,kt as a,Ve as b,c,ne as d,Ue as e,Ie as f,At as g,je as h,b as l,dt as s,Dt as w};
